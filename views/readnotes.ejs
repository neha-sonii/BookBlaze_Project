<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- stylesheet -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- font awesome cdn -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
        integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- favicon -->
      <link rel="shortcut icon" href="/images/brand logo png.png" type="image/x-icon">
    <title>Read Notes</title>
</head>

<body>
    <!-- header section starts here -->

    <%- include('partials/header',) %>

        <!-- header section ends here -->

        <!-- notes section starts here -->

        <div class="shop-img"></div>

        <div class="explore notes-bg">
            <div class="shop-title">
                <%= title %>
            </div>
            <% book.forEach(book=> { %>
                <div class="notes-card card-animate">
                    <div class="book-notes">

                        <div class="book-img">
                            <img src="https://covers.openlibrary.org/b/isbn/<%= book.isbn %>-L.jpg" alt="Book Cover"
                                style="height: 230px; width: 11rem;">
                        </div>
                        <div class="book-title">
                            <div class="book-title1">
                                <%= book.title %>
                            </div>
                            <div class="book-author">
                                <div>
                                   <b>Author</b> - <%= book.author %>
                                </div>
                                <div>
                                    <%= book.description %>
                                </div>
                                <div>
                                   <b>Genre</b> - <%= book.genre %>
                                </div>
                                
                                <div>‚≠ê <span>
                                        <%= book.rating %>/10
                                    </span></div>
                            </div>
                            
                        </div>
                    </div>
                    <h3>Notes: <%= book.title %>
                    </h3>
                    <br>
                    <ul>
                        <!-- if notes exist -->
                        <% if (book.notes && book.notes.length) { %>
                            <% book.notes.forEach(note=> { %>
                                <li class="note-item">
                                    <%= note %>
                                </li>
                                <% }) %>
                                    <% } else { %>
                                        <li>Try to refresh the Page.</li>
                                        <% } %>
                    </ul>
                </div>
                <% }) %>
        </div>

        <!-- notes section ends here -->

        <script src="/js/index.js"></script>
        <script>
            // Animate notes-card on scroll using Intersection Observer
            (function () {
                const cards = document.querySelectorAll('.card-animate');
                function showCard(entry, observer) {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('in-view');
                        observer.unobserve(entry.target);
                    }
                }
                if ('IntersectionObserver' in window) {
                    const observer = new IntersectionObserver((entries, observer) => {
                        entries.forEach(entry => {
                            showCard(entry, observer);
                        });
                    }, { threshold: 0.15 });
                    cards.forEach(card => {
                        observer.observe(card);
                    });
                } else {
                    // Fallback: show all cards if IntersectionObserver not supported
                    cards.forEach(card => card.classList.add('in-view'));
                }
            })();
            // Always show card if JS fails (noscript fallback)
            document.querySelectorAll('.card-animate').forEach(card => {
                if (!card.classList.contains('in-view')) {
                    card.classList.add('in-view');
                }
            });
        </script>